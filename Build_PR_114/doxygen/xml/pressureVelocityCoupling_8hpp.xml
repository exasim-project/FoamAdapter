<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="pressureVelocityCoupling_8hpp" kind="file" language="C++">
    <compoundname>pressureVelocityCoupling.hpp</compoundname>
    <includes refid="expression_8hpp" local="yes">FoamAdapter/datastructures/expression.hpp</includes>
    <includes local="yes">NeoN/NeoN.hpp</includes>
    <incdepgraph>
      <node id="1">
        <label>/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp</label>
        <link refid="pressureVelocityCoupling_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>FoamAdapter/auxiliary/convert.hpp</label>
        <link refid="convert_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>FoamAdapter/auxiliary/readers.hpp</label>
        <link refid="readers_8hpp"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>FoamAdapter/auxiliary/type_conversion.hpp</label>
        <link refid="type__conversion_8hpp"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>FoamAdapter/datastructures/expression.hpp</label>
        <link refid="expression_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>FoamAdapter/datastructures/meshAdapter.hpp</label>
        <link refid="meshAdapter_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>FoamAdapter/datastructures/runTime.hpp</label>
        <link refid="runTime_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>NeoN/NeoN.hpp</label>
      </node>
      <node id="5">
        <label>functional</label>
      </node>
      <node id="7">
        <label>fvMesh.H</label>
      </node>
      <node id="12">
        <label>fvc.H</label>
      </node>
      <node id="6">
        <label>memory</label>
      </node>
      <node id="15">
        <label>surfaceFields.H</label>
      </node>
      <node id="10">
        <label>type_traits</label>
      </node>
      <node id="14">
        <label>volFields.H</label>
      </node>
    </incdepgraph>
    <innernamespace refid="namespaceFoamAdapter">FoamAdapter</innernamespace>
    <sectiondef kind="typedef">
      <memberdef kind="typedef" id="pressureVelocityCoupling_8hpp_1acc912e7a5a44b028589fda3fd76ba7ea" prot="public" static="no">
        <type>NeoN::scalar</type>
        <definition>using scalar =  NeoN::scalar</definition>
        <argsstring></argsstring>
        <name>scalar</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp" line="11" column="1" bodyfile="/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp" bodystart="11" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="pressureVelocityCoupling_8hpp_1ae261b7f2859c508a432e8a334ad179d2" prot="public" static="no">
        <type>NeoN::Vec3</type>
        <definition>using Vec3 =  NeoN::Vec3</definition>
        <argsstring></argsstring>
        <name>Vec3</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp" line="12" column="1" bodyfile="/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp" bodystart="12" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>SPDX-License-Identifier:<sp/>GPL-3.0-or-later</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>SPDX-FileCopyrightText:<sp/>2025<sp/>FoamAdapter<sp/>authors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="expression_8hpp" kindref="compound">FoamAdapter/datastructures/expression.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;NeoN/NeoN.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">nnfvcc<sp/>=<sp/>NeoN::finiteVolume::cellCentred;</highlight></codeline>
<codeline lineno="11" refid="pressureVelocityCoupling_8hpp_1acc912e7a5a44b028589fda3fd76ba7ea" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="pressureVelocityCoupling_8hpp_1acc912e7a5a44b028589fda3fd76ba7ea" kindref="member">scalar</ref><sp/>=<sp/>NeoN::scalar;</highlight></codeline>
<codeline lineno="12" refid="pressureVelocityCoupling_8hpp_1ae261b7f2859c508a432e8a334ad179d2" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal"><ref refid="pressureVelocityCoupling_8hpp_1ae261b7f2859c508a432e8a334ad179d2" kindref="member">Vec3</ref><sp/>=<sp/>NeoN::Vec3;</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14" refid="namespaceFoamAdapter" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceFoamAdapter" kindref="compound">FoamAdapter</ref></highlight></codeline>
<codeline lineno="15"><highlight class="normal">{</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@brief<sp/>ensure<sp/>that<sp/>the<sp/>HbyA<sp/>does<sp/>not<sp/>violate<sp/>boundary<sp/>velocity<sp/>constraint</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>See<sp/>https://openfoamwiki.net/index.php/SimpleFoam<sp/>for<sp/>details</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>Cite:</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>The<sp/>velocity<sp/>at<sp/>the<sp/>boundary<sp/>face<sp/>should<sp/>satisfy<sp/>following<sp/>equation:</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>\bold{u}|_{bf}<sp/><sp/>=<sp/><sp/><sp/>\frac{\bold<sp/>{H[u]<sp/>}}{a_P<sp/>}|_{bf}<sp/>-<sp/><sp/>\frac{\nabla<sp/>p{}}{a_P<sp/>}|_{bf}</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>The<sp/>subscript<sp/>bf<sp/>denoted<sp/>that<sp/>the<sp/>quantity<sp/>is<sp/>evaluated<sp/>at<sp/>the<sp/>boundary<sp/>face.<sp/>The<sp/>function<sp/>constrainHbyA<sp/>ensures<sp/>that<sp/>the<sp/>field<sp/>&lt;math&gt;<sp/><sp/>\frac{\bold<sp/>{H[u]<sp/>}}{a_P<sp/>}|_{bf}<sp/>&lt;/math&gt;</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>does<sp/>not<sp/>violate<sp/>the<sp/>above<sp/>equation.<sp/>The<sp/>boundary<sp/>condition<sp/>fixedFluxExtrapolatedPressure<sp/>sets<sp/>the<sp/>pressure<sp/>gradient<sp/>in<sp/>order<sp/>that<sp/>the<sp/>above<sp/>equation<sp/>is<sp/>satisfied.<sp/>If<sp/>we<sp/>cannot<sp/>modify<sp/>the<sp/>velocity,<sp/>the<sp/>function<sp/>sets<sp/>the<sp/>field<sp/>&lt;math&gt;<sp/>\frac{\bold<sp/>{H[u]<sp/>}}{a_P<sp/>}|_{bf}<sp/><sp/>=<sp/>\bold{u}|_{bf}<sp/>&lt;/math&gt;<sp/>in<sp/>order<sp/>that<sp/>the<sp/>field<sp/><sp/>&lt;math&gt;<sp/><sp/>\frac{\bold<sp/>{H[u]<sp/>}}{a_P<sp/>}|_{bf}<sp/>&lt;/math&gt;<sp/>does<sp/>not<sp/>contradict<sp/>the<sp/>zero<sp/>gradient<sp/>boundary<sp/>condition<sp/>which<sp/>should<sp/>be<sp/>applied<sp/>for<sp/>the<sp/>pressure<sp/>if<sp/>the<sp/>velocity<sp/>is<sp/>fixed.</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27" refid="namespaceFoamAdapter_1a54bbeabff5f4044f250027a13ebe295d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceFoamAdapter_1a54bbeabff5f4044f250027a13ebe295d" kindref="member">constrainHbyA</ref>(</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/>nnfvcc::VolumeField&lt;Vec3&gt;&amp;<sp/>HbyA,</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>nnfvcc::VolumeField&lt;Vec3&gt;&amp;<sp/>U,</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>nnfvcc::VolumeField&lt;scalar&gt;&amp;<sp/>p</highlight></codeline>
<codeline lineno="31"><highlight class="normal">);</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@brief<sp/>given<sp/>a<sp/>...<sp/>this<sp/>function<sp/>computes<sp/>rAU</highlight></codeline>
<codeline lineno="34"><highlight class="comment">*</highlight></codeline>
<codeline lineno="35"><highlight class="comment">*<sp/>where<sp/>rAU<sp/><sp/>-<sp/>inverse<sp/>of<sp/>the<sp/>system<sp/>matrix<sp/>diagonal</highlight></codeline>
<codeline lineno="36"><highlight class="comment">*</highlight></codeline>
<codeline lineno="37"><highlight class="comment">*<sp/>@return<sp/>a<sp/>tuple<sp/>containing<sp/>rAU<sp/>and<sp/>HbyA</highlight></codeline>
<codeline lineno="38"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="namespaceFoamAdapter_1a3fcb65605aafdcc90b7315821bac79bb" refkind="member"><highlight class="normal">nnfvcc::VolumeField&lt;scalar&gt;<sp/><ref refid="namespaceFoamAdapter_1a3fcb65605aafdcc90b7315821bac79bb" kindref="member">computeRAU</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classFoamAdapter_1_1PDESolver" kindref="compound">PDESolver&lt;Vec3&gt;</ref>&amp;<sp/>expr);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@brief<sp/>given<sp/>a<sp/>...<sp/>this<sp/>function<sp/>computes<sp/>rAU<sp/>and<sp/>HbyA</highlight></codeline>
<codeline lineno="42"><highlight class="comment">*</highlight></codeline>
<codeline lineno="43"><highlight class="comment">*<sp/>where<sp/>rAU<sp/><sp/>-<sp/>inverse<sp/>of<sp/>the<sp/>system<sp/>matrix<sp/>diagonal</highlight></codeline>
<codeline lineno="44"><highlight class="comment">*<sp/><sp/><sp/><sp/><sp/><sp/><sp/>HbyA<sp/>-<sp/>offdiagonal<sp/>entries<sp/>divided<sp/>by<sp/>diagonal</highlight></codeline>
<codeline lineno="45"><highlight class="comment">*</highlight></codeline>
<codeline lineno="46"><highlight class="comment">*<sp/>@return<sp/>a<sp/>tuple<sp/>containing<sp/>rAU<sp/>and<sp/>HbyA</highlight></codeline>
<codeline lineno="47"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal">std::tuple&lt;nnfvcc::VolumeField&lt;scalar&gt;,<sp/>nnfvcc::VolumeField&lt;Vec3&gt;&gt;</highlight></codeline>
<codeline lineno="49" refid="namespaceFoamAdapter_1a3f31cf5e3f7cec8c725350be6371097c" refkind="member"><highlight class="normal"><ref refid="namespaceFoamAdapter_1a3f31cf5e3f7cec8c725350be6371097c" kindref="member">discreteMomentumFields</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classFoamAdapter_1_1PDESolver" kindref="compound">PDESolver&lt;Vec3&gt;</ref>&amp;<sp/>expr);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@brief</highlight></codeline>
<codeline lineno="52"><highlight class="comment">*</highlight></codeline>
<codeline lineno="53"><highlight class="comment">*<sp/>@note<sp/>assumes<sp/>an<sp/>assembled<sp/>system<sp/>matrix</highlight></codeline>
<codeline lineno="54"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="namespaceFoamAdapter_1aa70aa24d844e3320ed61ec135b7048ef" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceFoamAdapter_1aa70aa24d844e3320ed61ec135b7048ef" kindref="member">updateFaceVelocity</ref>(</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>nnfvcc::SurfaceField&lt;scalar&gt;&amp;<sp/>phi,</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>nnfvcc::SurfaceField&lt;scalar&gt;&amp;<sp/>predictedPhi,</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classFoamAdapter_1_1PDESolver" kindref="compound">PDESolver&lt;scalar&gt;</ref>&amp;<sp/>expr</highlight></codeline>
<codeline lineno="59"><highlight class="normal">);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>@brief</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64" refid="namespaceFoamAdapter_1ab07cdffe2f504299318aad761dfd4b9b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceFoamAdapter_1ab07cdffe2f504299318aad761dfd4b9b" kindref="member">updateVelocity</ref>(</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>nnfvcc::VolumeField&lt;Vec3&gt;&amp;<sp/>U,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>nnfvcc::VolumeField&lt;Vec3&gt;&amp;<sp/>HbyA,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>nnfvcc::VolumeField&lt;scalar&gt;&amp;<sp/>rAU,</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>nnfvcc::VolumeField&lt;scalar&gt;&amp;<sp/>p</highlight></codeline>
<codeline lineno="69"><highlight class="normal">);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>@brief<sp/>Reimplementation<sp/>of<sp/>OpenFOAMs<sp/>fvMatrix.flux()</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/>@return<sp/>flux<sp/>surface<sp/>field</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75" refid="namespaceFoamAdapter_1aeb9d6048345debcb9e018bb2e75436b3" refkind="member"><highlight class="normal">nnfvcc::SurfaceField&lt;scalar&gt;<sp/><ref refid="namespaceFoamAdapter_1aeb9d6048345debcb9e018bb2e75436b3" kindref="member">flux</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>nnfvcc::VolumeField&lt;Vec3&gt;&amp;<sp/>volField);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/runner/work/FoamAdapter/FoamAdapter/include/FoamAdapter/algorithms/pressureVelocityCoupling.hpp"/>
  </compounddef>
</doxygen>
